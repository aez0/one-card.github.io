<!DOCTYPE html>
<html>
  <head>
    <title>My Notes - OneCard</title>
    <link rel="stylesheet" href="https://one-card.github.io/assets/notes.css">
    <link rel="stylesheet" href="https://nanomotion.github.io/assets/css/sweetalert.css">
    <link href="https://one-card.github.io/favicon.ico" rel="icon" type="image/x-icon">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script async src="https://www.gstatic.com/firebasejs/3.7.8/firebase.js"></script>
    <script async src="https://www.gstatic.com/firebasejs/3.8.0/firebase-storage.js"></script>
    <script async src="https://nanomotion.github.io/assets/js/sweetalert.min.js"></script>
    <meta name="google-signin-client_id" content="715078466665-pj5cpqhuicccp7pkkj7gg8oaqu2fehk6.apps.googleusercontent.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script async>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyCkyrIrVktUomIn2HDn7sRw7woLcITePuc",
        authDomain: "one-card-6eb00.firebaseapp.com",
        databaseURL: "https://one-card-6eb00.firebaseio.com",
        projectId: "one-card-6eb00",
        storageBucket: "one-card-6eb00.appspot.com",
        messagingSenderId: "601405421027"
      };
      firebase.initializeApp(config);
      var storage = firebase.storage();
      var storageRef = storage.ref();
      var notesRef = storageRef.child("notes");
      
      // Handle Google Signin
      function onSignIn(googleUser) {
        var profile = googleUser.getBasicProfile();
        console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
        console.log('Name: ' + profile.getName());
        console.log('Image URL: ' + profile.getImageUrl());
        console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
        var id_token = googleUser.getAuthResponse().id_token;
        console.log("ID Token: " + id_token);
      }
      function signOut() {
        var auth2 = gapi.auth2.getAuthInstance();
        auth2.signOut().then(function () {
          console.log("signed out");
        });
      }
    </script>
  </head>
  <body>
    <div class="announcement" id="no-backend">
      <span style="float: right; cursor: pointer;" onclick="document.getElementById('no-backend').style.display = 'none';">&times;</span>Thanks for checking out OneCard! Unfortunately, we just started and backend hasn't been implemented yet, so your notes won't save.
    </div>
    <div class="navbar">
      <a href="https://one-card.github.io"><img src="https://one-card.github.io/assets/onecard.svg" /> OneCard</a>
      <a style="float: right;" href="https://one-card.github.io/account">My Account</a>
      <a style="float: right;" href="https://one-card.github.io/help">Help</a>
      <div style="display: none;" class="g-signin2" data-onsuccess="onSignIn" data-onfailure="onSigninFailure" data-theme="dark"></div>
    </div>
    <h1 style="text-align: center;">My Notes</h1>
    <center><button onclick="newElement()">Create a new note</button> <button onclick="resetNotes()">Clear all notes</button></center>
    <ul class="note-area">
      <li data-noteid="1" draggable="true"><span onClick='noteTools()'>☰</span><span onclick='this.parentElement.outerHTML = "";' class='close'>&times;</span><textarea autofocus placeholder='Enter note text here...'>Welcome to OneCard! Need help? Check out the Help Center by clicking 'Help' above. Happy note-taking!</textarea></li>
    </ul>
    <script>
      var id = 2
      
      function newElement() {
        var li = document.createElement("li");
        li.innerHTML = "<span onClick='noteTools()'>☰</span><span onclick='this.parentElement.outerHTML = \"\";' class='close'>&times;</span><textarea placeholder='Enter note text here...'></textarea>";
        document.getElementsByClassName("note-area")[0].appendChild(li);
        li.setattribute("id", "note" + String(id));
        li.setattribute("data-noteid", "true");
        var id = id + 1
      }
      
      function resetNotes() {
        document.getElementsByClassName("note-area")[0].innerHTML = "";
      }
      
      function noteTools() {
        swal("Error", "This feature doesn't work yet!", "error")
      }
    </script>
    <script async>
      var dragSrcEl = null;

      function handleDragStart(e) {
          // Target (this) element is the source node.
          this.style.opacity = '0.4';

          dragSrcEl = this;

          e.dataTransfer.effectAllowed = 'move';
          e.dataTransfer.setData('text/html', this.innerHTML);
      }

      function handleDragOver(e) {
          if (e.preventDefault) {
              e.preventDefault(); // Necessary. Allows us to drop.
          }

          e.dataTransfer.dropEffect = 'move';  // See the section on the DataTransfer object.

          return false;
      }

      function handleDragEnter(e) {
          // this / e.target is the current hover target.
          this.classList.add('over');
      }

      function handleDragLeave(e) {
          this.classList.remove('over');  // this / e.target is previous target element.
      }

      function handleDrop(e) {
          // this/e.target is current target element.

          if (e.stopPropagation) {
              e.stopPropagation(); // Stops some browsers from redirecting.
          }

          // Don't do anything if dropping the same column we're dragging.
          if (dragSrcEl != this) {
              // Set the source column's HTML to the HTML of the column we dropped on.
              dragSrcEl.innerHTML = this.innerHTML;
              this.innerHTML = e.dataTransfer.getData('text/html');
          }

          return false;
      }

      function handleDragEnd(e) {
          // this/e.target is the source node.

          [].forEach.call(cols, function (col) {
              col.classList.remove('over');
          });
      }

      var cols = document.querySelectorAll('#parent .parent');
      [].forEach.call(cols, function (col) {
          col.addEventListener('dragstart', handleDragStart, false);
          col.addEventListener('dragenter', handleDragEnter, false)
          col.addEventListener('dragover', handleDragOver, false);
          col.addEventListener('dragleave', handleDragLeave, false);
          col.addEventListener('drop', handleDrop, false);
          col.addEventListener('dragend', handleDragEnd, false);
      });
    </script>
  </body>
</html>
